# Настоящий документ описывает аппаратную реализацию узла, к которому подключается внешний модуль
***
## Соглашение о терминах
* ***Команда*** - инструкция для выполнения каких-либо действий;
* ***Ответ*** - отклик устройства, получившего определённую команду;
* ***Параметр*** - характеристика, определяющая поведение какого-либо объекта (например - датчика), которую можно прочитать и изменить;
* ***Данные*** - результат измерения датчика - физические единицы измеренной величины, представленные в виде числа с плавающей точкой;
* ***MASTER*** - ведущее устройство, обеспечивающее взаимодействие с приложением по Bluetooth и считывание данных с датчиков, а также фильтрацию и калибровку данных;
* ***MODULE*** - ведомое устройство, обеспечивающее работу с реальным физическим датчиком (датчиками) и нормирование "сырых" величин к виду данных.
***
В аппаратном смысле узел MASTER построен на основе модуля ESP32-WROVER-E (со встроенной PCB антенной) от Espressif. На нём задействован UART1. В следующей таблице показано, какие пины MASTER подключаются к MODULE и их назначение:

|Пин ESP         |MASTER          |Назначение                          |Подключается к \<pin\> на MODULE |                                    
|:--------------:|:--------------:|------------------------------------|:-------------------------------:|
|IO23            |ESP32_TX1       |Передача данных к MODULE            |RX                               |
|IO22            |ESP32_RX1       |Приём данных от MODULE              |TX                               |
|IO21(pull-down) |ESP32_BREAKFLOW |Управление потоком данных от MODULE |BREAKFLOW                        |
|IO18(pull-up)   |ESP32_RESET     |Сброс MODULE                        |RESET                            |  

Активный логический уровень на TX, RX, RESET - логический ноль, на BREAKFLOW - логическая единица. BREAKFLOW притянут к минусу питания ESP32, RESET притянут к плюсу питания ESP32 (3V3).
***
## Возможны следующие варианты реализации MASTER-а
### Использование ESP32-WROVER-E в "чистом" виде, распаяв его на плате разрабатываемого устройства
<p align="center">
  <img src="/related-documents/pictures/esp32-wrover-e-view.png">
</p>
Следует помнить, что для прошивки данного модуля потребуется или внешний программатор (для него нужно будет вывести разъём) или разместить программатор непосредственно на плате целевого устройства. Схема для второго случая представлена ниже:
<p align="center">
  <img src="/related-documents/schematics/esp32-wrover-e-single-module.png">
</p>  

### Использование отладочной платы LOLIN D32 PRO
<p align="center">
  <img src="/related-documents/pictures/lolin-d32-pro-view.png">
</p>
В данном варианте программатор уже размещён на плате модуля. Пины интерфейса те же самые, питание можно подать на USB-разъём или на пин VBUS.
